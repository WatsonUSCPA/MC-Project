{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\what1\\\\OneDrive\\\\Desktop\\\\Project\\\\MCProject_Beta\\\\mc-square-react\\\\src\\\\Success.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { useCart } from './CartContext';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, doc, getDoc, updateDoc } from 'firebase/firestore';\nimport { app } from './firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst db = getFirestore(app);\nconst auth = getAuth(app);\nconst Success = () => {\n  _s();\n  const {\n    clearCart\n  } = useCart();\n  // 購入商品・合計金額をlocalStorageから取得\n  const [orderItems, setOrderItems] = useState([]);\n  const [paidAmount, setPaidAmount] = useState(0);\n  const [shipping, setShipping] = useState(0);\n  useEffect(() => {\n    // 1. localStorageから明細を取得\n    try {\n      const itemsStr = localStorage.getItem('mcSquareLastOrderItems');\n      if (itemsStr) setOrderItems(JSON.parse(itemsStr));\n      const paidAmountStr = localStorage.getItem('mcSquareLastPaidAmount');\n      if (paidAmountStr) setPaidAmount(parseInt(paidAmountStr, 10));\n      const shippingStr = localStorage.getItem('mcSquareLastShipping');\n      if (shippingStr) setShipping(parseInt(shippingStr, 10));\n    } catch {}\n\n    // すでに処理済みなら何もしない\n    if (localStorage.getItem('mcSquareOrderProcessed') === '1') return;\n    let processed = false;\n    const process = user => {\n      if (!processed && user) {\n        saveOrder(user);\n        processed = true;\n        localStorage.setItem('mcSquareOrderProcessed', '1');\n      }\n    };\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      process(user);\n      if (user) unsubscribe();\n    });\n    if (auth.currentUser) {\n      process(auth.currentUser);\n      unsubscribe();\n    }\n    return () => unsubscribe();\n  }, []);\n\n  // saveOrderを外に出す\n  const saveOrder = async user => {\n    if (!user) return;\n    try {\n      const userRef = doc(db, 'users', user.uid);\n      const userSnap = await getDoc(userRef);\n      if (!userSnap.exists()) return;\n\n      // 購入履歴追加\n      if (orderItems.length > 0) {\n        const prevOrders = userSnap.data().orders || [];\n        const now = new Date();\n        const orderRecord = {\n          date: now.toISOString(),\n          items: orderItems,\n          total: paidAmount,\n          shipping: shipping\n        };\n        await updateDoc(userRef, {\n          orders: [...prevOrders, orderRecord]\n        });\n        console.log('購入履歴追加:', orderRecord);\n      }\n\n      // 処理後はlocalStorageをクリア\n      localStorage.removeItem('mcSquareLastPaidAmount');\n      localStorage.removeItem('mcSquareLastOrderItems');\n      localStorage.removeItem('mcSquareLastShipping');\n    } catch (e) {\n      console.error('購入履歴追加エラー:', e);\n    }\n  };\n\n  // 必要な情報が全て揃ったら履歴保存\n  useEffect(() => {\n    // 処理フラグをリセット（決済ごとに必ずリセット）\n    localStorage.removeItem('mcSquareOrderProcessed');\n    let processed = false;\n    const process = user => {\n      if (!processed && user) {\n        saveOrder(user);\n        processed = true;\n      }\n    };\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      process(user);\n      if (user) unsubscribe();\n    });\n    // すでにログイン済みなら即実行\n    if (auth.currentUser) {\n      process(auth.currentUser);\n      unsubscribe();\n    }\n    // クリーンアップ\n    return () => unsubscribe();\n  }, [clearCart, orderItems, paidAmount, shipping]);\n\n  // 小計計算\n  const subtotal = orderItems.reduce((sum, item) => {\n    const priceNum = Number(String(item.price).replace(/[^\\d.]/g, ''));\n    return sum + priceNum * item.quantity;\n  }, 0);\n\n  // 画像パス正規化\n  const getImageSrc = url => {\n    if (!url) return '/Image/MC square Logo.png';\n    if (url.startsWith('http://') || url.startsWith('https://')) return url;\n    if (url.startsWith('/Image/')) return url;\n    if (url.startsWith('Image/')) return '/' + url;\n    return '/Image/MC square Logo.png';\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      maxWidth: 800,\n      margin: '2em auto',\n      padding: '0 1em'\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        background: '#fff',\n        borderRadius: 20,\n        padding: '2rem',\n        boxShadow: '0 4px 16px rgba(255,159,124,0.10)',\n        border: '1px solid #FFD4C4'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        style: {\n          color: 'var(--color-primary)',\n          fontSize: '2rem',\n          marginBottom: '1.5rem',\n          textAlign: 'center'\n        },\n        children: \"\\uD83C\\uDF89 \\u3054\\u8CFC\\u5165\\u3042\\u308A\\u304C\\u3068\\u3046\\u3054\\u3056\\u3044\\u307E\\u3059\\uFF01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#f8f9fa',\n          borderRadius: 12,\n          padding: '1.5rem',\n          marginBottom: '2rem'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            color: '#333',\n            fontSize: '1.3rem',\n            marginBottom: '1rem'\n          },\n          children: \"\\u6CE8\\u6587\\u5185\\u5BB9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 11\n        }, this), orderItems.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '1rem',\n            padding: '0.8rem 0',\n            borderBottom: index < orderItems.length - 1 ? '1px solid #e0e0e0' : 'none'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: getImageSrc(item.imageUrl),\n            alt: item.name,\n            style: {\n              width: 60,\n              height: 60,\n              objectFit: 'cover',\n              borderRadius: 8,\n              border: '1px solid #e0e0e0'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontWeight: 600,\n                fontSize: '1.1em',\n                marginBottom: '0.3em'\n              },\n              children: item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 132,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#666',\n                fontSize: '0.95em'\n              },\n              children: [\"\\u6570\\u91CF: \", item.quantity, \"\\u500B\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 133,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontWeight: 700,\n              color: 'var(--color-primary)',\n              fontSize: '1.1em'\n            },\n            children: [(Number(String(item.price).replace(/[^\\d.]/g, '')) * item.quantity).toLocaleString(), \"\\u5186\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 13\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '1.5rem',\n            paddingTop: '1rem',\n            borderTop: '2px solid #e0e0e0'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              marginBottom: '0.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u5C0F\\u8A08:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 143,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [subtotal.toLocaleString(), \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 144,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              marginBottom: '0.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u9001\\u6599:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [shipping.toLocaleString(), \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              justifyContent: 'space-between',\n              fontWeight: 700,\n              fontSize: '1.2em',\n              color: 'var(--color-primary)',\n              borderTop: '1px solid #e0e0e0',\n              paddingTop: '0.5rem'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u5408\\u8A08:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [paidAmount.toLocaleString(), \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 152,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 150,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'center',\n          marginBottom: '2rem'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: '#666',\n            lineHeight: 1.6,\n            marginBottom: '1rem'\n          },\n          children: [\"\\u3054\\u6CE8\\u6587\\u306E\\u78BA\\u8A8D\\u30E1\\u30FC\\u30EB\\u3092\\u304A\\u9001\\u308A\\u3057\\u307E\\u3057\\u305F\\u3002\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 31\n          }, this), \"\\u5546\\u54C1\\u306E\\u767A\\u9001\\u6E96\\u5099\\u304C\\u6574\\u3044\\u6B21\\u7B2C\\u3001\\u767A\\u9001\\u901A\\u77E5\\u30E1\\u30FC\\u30EB\\u3092\\u304A\\u9001\\u308A\\u3044\\u305F\\u3057\\u307E\\u3059\\u3002\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/all-products\",\n          style: {\n            background: 'var(--color-primary)',\n            color: '#fff',\n            textDecoration: 'none',\n            padding: '0.8em 2em',\n            borderRadius: 12,\n            fontWeight: 700,\n            fontSize: '1.1em',\n            display: 'inline-block',\n            boxShadow: '0 2px 8px rgba(255, 159, 124, 0.10)'\n          },\n          children: \"\\u5546\\u54C1\\u4E00\\u89A7\\u306B\\u623B\\u308B\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 121,\n    columnNumber: 5\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '3em 1em',\n      textAlign: 'center'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        color: '#E1306C',\n        marginBottom: '1em'\n      },\n      children: \"\\u3054\\u8CFC\\u5165\\u3042\\u308A\\u304C\\u3068\\u3046\\u3054\\u3056\\u3044\\u307E\\u3057\\u305F\\uFF01\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"\\u3054\\u6CE8\\u6587\\u304C\\u6B63\\u5E38\\u306B\\u5B8C\\u4E86\\u3057\\u307E\\u3057\\u305F\\u3002\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 24\n      }, this), \"\\u3054\\u767B\\u9332\\u306E\\u30E1\\u30FC\\u30EB\\u30A2\\u30C9\\u30EC\\u30B9\\u306B\\u78BA\\u8A8D\\u30E1\\u30FC\\u30EB\\u3092\\u304A\\u9001\\u308A\\u3057\\u3066\\u3044\\u307E\\u3059\\u3002\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this), orderItems.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        margin: '2em auto',\n        maxWidth: 600,\n        background: '#fff',\n        borderRadius: 16,\n        boxShadow: '0 4px 16px rgba(255,159,124,0.10)',\n        padding: '2em'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        style: {\n          color: '#E1306C',\n          marginBottom: 16,\n          fontSize: '1.15em'\n        },\n        children: \"\\u3054\\u8CFC\\u5165\\u5546\\u54C1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          listStyle: 'none',\n          padding: 0,\n          margin: 0,\n          marginBottom: '1.5em'\n        },\n        children: orderItems.map((item, idx) => /*#__PURE__*/_jsxDEV(\"li\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: 14,\n            marginBottom: 18,\n            borderBottom: '1px solid #eee',\n            paddingBottom: 10\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: getImageSrc(item.imageUrl),\n            alt: item.name,\n            style: {\n              width: 48,\n              height: 48,\n              objectFit: 'cover',\n              borderRadius: 8,\n              border: '1px solid #eee',\n              background: '#fafafa'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              flex: 1,\n              textAlign: 'left'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontWeight: 700\n              },\n              children: item.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                color: '#636E72',\n                fontSize: '0.97em'\n              },\n              children: [\"\\u6570\\u91CF: \", item.quantity, \"\\u3000\\u5358\\u4FA1: \", Number(item.price).toLocaleString(), \"\\u5186\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 17\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          borderTop: '2px solid #eee',\n          paddingTop: '1em'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            marginBottom: '0.5em',\n            fontSize: '1em'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u5C0F\\u8A08:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [subtotal.toLocaleString(), \"\\u5186\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            marginBottom: '0.5em',\n            fontSize: '1em'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u9001\\u6599:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: shipping === 0 ? '無料' : shipping.toLocaleString() + '円'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            marginTop: '1em',\n            fontWeight: 700,\n            fontSize: '1.15em',\n            color: '#E1306C',\n            borderTop: '1px solid #eee',\n            paddingTop: '0.5em'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"\\u304A\\u652F\\u6255\\u3044\\u5408\\u8A08:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [paidAmount.toLocaleString(), \"\\u5186\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n      href: \"/all-products\",\n      style: {\n        display: 'inline-block',\n        marginTop: '2em',\n        color: '#fff',\n        background: '#E1306C',\n        padding: '0.8em 2em',\n        borderRadius: 8,\n        textDecoration: 'none',\n        fontWeight: 700\n      },\n      children: \"\\u5546\\u54C1\\u4E00\\u89A7\\u3078\\u623B\\u308B\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 184,\n    columnNumber: 5\n  }, this);\n};\n_s(Success, \"9x/t3RaTAPJiH8gX2Jut/bRGKHg=\", false, function () {\n  return [useCart];\n});\n_c = Success;\nexport default Success;\nvar _c;\n$RefreshReg$(_c, \"Success\");","map":{"version":3,"names":["React","useEffect","useState","useCart","getAuth","onAuthStateChanged","getFirestore","doc","getDoc","updateDoc","app","jsxDEV","_jsxDEV","db","auth","Success","_s","clearCart","orderItems","setOrderItems","paidAmount","setPaidAmount","shipping","setShipping","itemsStr","localStorage","getItem","JSON","parse","paidAmountStr","parseInt","shippingStr","processed","process","user","saveOrder","setItem","unsubscribe","currentUser","userRef","uid","userSnap","exists","length","prevOrders","data","orders","now","Date","orderRecord","date","toISOString","items","total","console","log","removeItem","e","error","subtotal","reduce","sum","item","priceNum","Number","String","price","replace","quantity","getImageSrc","url","startsWith","style","maxWidth","margin","padding","children","background","borderRadius","boxShadow","border","color","fontSize","marginBottom","textAlign","fileName","_jsxFileName","lineNumber","columnNumber","map","index","display","alignItems","gap","borderBottom","src","imageUrl","alt","name","width","height","objectFit","flex","fontWeight","toLocaleString","marginTop","paddingTop","borderTop","justifyContent","lineHeight","Link","to","textDecoration","listStyle","idx","paddingBottom","href","_c","$RefreshReg$"],"sources":["C:/Users/what1/OneDrive/Desktop/Project/MCProject_Beta/mc-square-react/src/Success.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useCart } from './CartContext';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, doc, getDoc, updateDoc } from 'firebase/firestore';\nimport { app } from './firebase';\n\nconst db = getFirestore(app);\nconst auth = getAuth(app);\n\nconst Success: React.FC = () => {\n  const { clearCart } = useCart();\n  // 購入商品・合計金額をlocalStorageから取得\n  const [orderItems, setOrderItems] = useState<any[]>([]);\n  const [paidAmount, setPaidAmount] = useState<number>(0);\n  const [shipping, setShipping] = useState<number>(0);\n\n  useEffect(() => {\n    // 1. localStorageから明細を取得\n    try {\n      const itemsStr = localStorage.getItem('mcSquareLastOrderItems');\n      if (itemsStr) setOrderItems(JSON.parse(itemsStr));\n      const paidAmountStr = localStorage.getItem('mcSquareLastPaidAmount');\n      if (paidAmountStr) setPaidAmount(parseInt(paidAmountStr, 10));\n      const shippingStr = localStorage.getItem('mcSquareLastShipping');\n      if (shippingStr) setShipping(parseInt(shippingStr, 10));\n    } catch {}\n\n    // すでに処理済みなら何もしない\n    if (localStorage.getItem('mcSquareOrderProcessed') === '1') return;\n\n    let processed = false;\n    const process = (user: any) => {\n      if (!processed && user) {\n        saveOrder(user);\n        processed = true;\n        localStorage.setItem('mcSquareOrderProcessed', '1');\n      }\n    };\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      process(user);\n      if (user) unsubscribe();\n    });\n    if (auth.currentUser) {\n      process(auth.currentUser);\n      unsubscribe();\n    }\n    return () => unsubscribe();\n  }, []);\n\n  // saveOrderを外に出す\n  const saveOrder = async (user: any) => {\n    if (!user) return;\n    try {\n      const userRef = doc(db, 'users', user.uid);\n      const userSnap = await getDoc(userRef);\n      if (!userSnap.exists()) return;\n      \n      // 購入履歴追加\n      if (orderItems.length > 0) {\n        const prevOrders = userSnap.data().orders || [];\n        const now = new Date();\n        const orderRecord = {\n          date: now.toISOString(),\n          items: orderItems,\n          total: paidAmount,\n          shipping: shipping\n        };\n        await updateDoc(userRef, { orders: [...prevOrders, orderRecord] });\n        console.log('購入履歴追加:', orderRecord);\n      }\n      \n      // 処理後はlocalStorageをクリア\n      localStorage.removeItem('mcSquareLastPaidAmount');\n      localStorage.removeItem('mcSquareLastOrderItems');\n      localStorage.removeItem('mcSquareLastShipping');\n    } catch (e) {\n      console.error('購入履歴追加エラー:', e);\n    }\n  };\n\n  // 必要な情報が全て揃ったら履歴保存\n  useEffect(() => {\n    // 処理フラグをリセット（決済ごとに必ずリセット）\n    localStorage.removeItem('mcSquareOrderProcessed');\n    let processed = false;\n    const process = (user: any) => {\n      if (!processed && user) {\n        saveOrder(user);\n        processed = true;\n      }\n    };\n    const unsubscribe = onAuthStateChanged(auth, user => {\n      process(user);\n      if (user) unsubscribe();\n    });\n    // すでにログイン済みなら即実行\n    if (auth.currentUser) {\n      process(auth.currentUser);\n      unsubscribe();\n    }\n    // クリーンアップ\n    return () => unsubscribe();\n  }, [clearCart, orderItems, paidAmount, shipping]);\n\n  // 小計計算\n  const subtotal = orderItems.reduce((sum, item) => {\n    const priceNum = Number(String(item.price).replace(/[^\\d.]/g, ''));\n    return sum + priceNum * item.quantity;\n  }, 0);\n\n  // 画像パス正規化\n  const getImageSrc = (url?: string) => {\n    if (!url) return '/Image/MC square Logo.png';\n    if (url.startsWith('http://') || url.startsWith('https://')) return url;\n    if (url.startsWith('/Image/')) return url;\n    if (url.startsWith('Image/')) return '/' + url;\n    return '/Image/MC square Logo.png';\n  };\n\n  return (\n    <div style={{ maxWidth: 800, margin: '2em auto', padding: '0 1em' }}>\n      <div style={{ background: '#fff', borderRadius: 20, padding: '2rem', boxShadow: '0 4px 16px rgba(255,159,124,0.10)', border: '1px solid #FFD4C4' }}>\n        <h1 style={{ color: 'var(--color-primary)', fontSize: '2rem', marginBottom: '1.5rem', textAlign: 'center' }}>🎉 ご購入ありがとうございます！</h1>\n        \n        <div style={{ background: '#f8f9fa', borderRadius: 12, padding: '1.5rem', marginBottom: '2rem' }}>\n          <h2 style={{ color: '#333', fontSize: '1.3rem', marginBottom: '1rem' }}>注文内容</h2>\n          \n          {orderItems.map((item, index) => (\n            <div key={index} style={{ display: 'flex', alignItems: 'center', gap: '1rem', padding: '0.8rem 0', borderBottom: index < orderItems.length - 1 ? '1px solid #e0e0e0' : 'none' }}>\n              <img src={getImageSrc(item.imageUrl)} alt={item.name} style={{ width: 60, height: 60, objectFit: 'cover', borderRadius: 8, border: '1px solid #e0e0e0' }} />\n              <div style={{ flex: 1 }}>\n                <div style={{ fontWeight: 600, fontSize: '1.1em', marginBottom: '0.3em' }}>{item.name}</div>\n                <div style={{ color: '#666', fontSize: '0.95em' }}>数量: {item.quantity}個</div>\n              </div>\n              <div style={{ fontWeight: 700, color: 'var(--color-primary)', fontSize: '1.1em' }}>\n                {(Number(String(item.price).replace(/[^\\d.]/g, '')) * item.quantity).toLocaleString()}円\n              </div>\n            </div>\n          ))}\n          \n          <div style={{ marginTop: '1.5rem', paddingTop: '1rem', borderTop: '2px solid #e0e0e0' }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n              <span>小計:</span>\n              <span>{subtotal.toLocaleString()}円</span>\n            </div>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5rem' }}>\n              <span>送料:</span>\n              <span>{shipping.toLocaleString()}円</span>\n            </div>\n            <div style={{ display: 'flex', justifyContent: 'space-between', fontWeight: 700, fontSize: '1.2em', color: 'var(--color-primary)', borderTop: '1px solid #e0e0e0', paddingTop: '0.5rem' }}>\n              <span>合計:</span>\n              <span>{paidAmount.toLocaleString()}円</span>\n            </div>\n          </div>\n        </div>\n        \n        <div style={{ textAlign: 'center', marginBottom: '2rem' }}>\n          <p style={{ color: '#666', lineHeight: 1.6, marginBottom: '1rem' }}>\n            ご注文の確認メールをお送りしました。<br />\n            商品の発送準備が整い次第、発送通知メールをお送りいたします。\n          </p>\n        </div>\n        \n        <div style={{ textAlign: 'center' }}>\n          <Link to=\"/all-products\" style={{ \n            background: 'var(--color-primary)', \n            color: '#fff', \n            textDecoration: 'none', \n            padding: '0.8em 2em', \n            borderRadius: 12, \n            fontWeight: 700, \n            fontSize: '1.1em',\n            display: 'inline-block',\n            boxShadow: '0 2px 8px rgba(255, 159, 124, 0.10)'\n          }}>\n            商品一覧に戻る\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n\n  return (\n    <div style={{ padding: '3em 1em', textAlign: 'center' }}>\n      <h1 style={{ color: '#E1306C', marginBottom: '1em' }}>ご購入ありがとうございました！</h1>\n      <p>ご注文が正常に完了しました。<br />ご登録のメールアドレスに確認メールをお送りしています。</p>\n      \n      {/* 購入商品リスト表示 */}\n      {orderItems.length > 0 && (\n        <div style={{ margin: '2em auto', maxWidth: 600, background: '#fff', borderRadius: 16, boxShadow: '0 4px 16px rgba(255,159,124,0.10)', padding: '2em' }}>\n          <h3 style={{ color: '#E1306C', marginBottom: 16, fontSize: '1.15em' }}>ご購入商品</h3>\n          \n          {/* 商品リスト */}\n          <ul style={{ listStyle: 'none', padding: 0, margin: 0, marginBottom: '1.5em' }}>\n            {orderItems.map((item, idx) => (\n              <li key={idx} style={{ display: 'flex', alignItems: 'center', gap: 14, marginBottom: 18, borderBottom: '1px solid #eee', paddingBottom: 10 }}>\n                <img src={getImageSrc(item.imageUrl)} alt={item.name} style={{ width: 48, height: 48, objectFit: 'cover', borderRadius: 8, border: '1px solid #eee', background: '#fafafa' }} />\n                <div style={{ flex: 1, textAlign: 'left' }}>\n                  <div style={{ fontWeight: 700 }}>{item.name}</div>\n                  <div style={{ color: '#636E72', fontSize: '0.97em' }}>数量: {item.quantity}　単価: {Number(item.price).toLocaleString()}円</div>\n                </div>\n              </li>\n            ))}\n          </ul>\n\n          {/* 金額詳細 */}\n          <div style={{ borderTop: '2px solid #eee', paddingTop: '1em' }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5em', fontSize: '1em' }}>\n              <span>小計:</span>\n              <span>{subtotal.toLocaleString()}円</span>\n            </div>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '0.5em', fontSize: '1em' }}>\n              <span>送料:</span>\n              <span>{shipping === 0 ? '無料' : shipping.toLocaleString() + '円'}</span>\n            </div>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginTop: '1em', fontWeight: 700, fontSize: '1.15em', color: '#E1306C', borderTop: '1px solid #eee', paddingTop: '0.5em' }}>\n              <span>お支払い合計:</span>\n              <span>{paidAmount.toLocaleString()}円</span>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      <a href=\"/all-products\" style={{ display: 'inline-block', marginTop: '2em', color: '#fff', background: '#E1306C', padding: '0.8em 2em', borderRadius: 8, textDecoration: 'none', fontWeight: 700 }}>商品一覧へ戻る</a>\n    </div>\n  );\n};\n\nexport default Success; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,OAAO,QAAQ,eAAe;AACvC,SAASC,OAAO,EAAEC,kBAAkB,QAAQ,eAAe;AAC3D,SAASC,YAAY,EAAEC,GAAG,EAAEC,MAAM,EAAEC,SAAS,QAAQ,oBAAoB;AACzE,SAASC,GAAG,QAAQ,YAAY;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEjC,MAAMC,EAAE,GAAGP,YAAY,CAACI,GAAG,CAAC;AAC5B,MAAMI,IAAI,GAAGV,OAAO,CAACM,GAAG,CAAC;AAEzB,MAAMK,OAAiB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC9B,MAAM;IAAEC;EAAU,CAAC,GAAGd,OAAO,CAAC,CAAC;EAC/B;EACA,MAAM,CAACe,UAAU,EAAEC,aAAa,CAAC,GAAGjB,QAAQ,CAAQ,EAAE,CAAC;EACvD,MAAM,CAACkB,UAAU,EAAEC,aAAa,CAAC,GAAGnB,QAAQ,CAAS,CAAC,CAAC;EACvD,MAAM,CAACoB,QAAQ,EAAEC,WAAW,CAAC,GAAGrB,QAAQ,CAAS,CAAC,CAAC;EAEnDD,SAAS,CAAC,MAAM;IACd;IACA,IAAI;MACF,MAAMuB,QAAQ,GAAGC,YAAY,CAACC,OAAO,CAAC,wBAAwB,CAAC;MAC/D,IAAIF,QAAQ,EAAEL,aAAa,CAACQ,IAAI,CAACC,KAAK,CAACJ,QAAQ,CAAC,CAAC;MACjD,MAAMK,aAAa,GAAGJ,YAAY,CAACC,OAAO,CAAC,wBAAwB,CAAC;MACpE,IAAIG,aAAa,EAAER,aAAa,CAACS,QAAQ,CAACD,aAAa,EAAE,EAAE,CAAC,CAAC;MAC7D,MAAME,WAAW,GAAGN,YAAY,CAACC,OAAO,CAAC,sBAAsB,CAAC;MAChE,IAAIK,WAAW,EAAER,WAAW,CAACO,QAAQ,CAACC,WAAW,EAAE,EAAE,CAAC,CAAC;IACzD,CAAC,CAAC,MAAM,CAAC;;IAET;IACA,IAAIN,YAAY,CAACC,OAAO,CAAC,wBAAwB,CAAC,KAAK,GAAG,EAAE;IAE5D,IAAIM,SAAS,GAAG,KAAK;IACrB,MAAMC,OAAO,GAAIC,IAAS,IAAK;MAC7B,IAAI,CAACF,SAAS,IAAIE,IAAI,EAAE;QACtBC,SAAS,CAACD,IAAI,CAAC;QACfF,SAAS,GAAG,IAAI;QAChBP,YAAY,CAACW,OAAO,CAAC,wBAAwB,EAAE,GAAG,CAAC;MACrD;IACF,CAAC;IACD,MAAMC,WAAW,GAAGhC,kBAAkB,CAACS,IAAI,EAAEoB,IAAI,IAAI;MACnDD,OAAO,CAACC,IAAI,CAAC;MACb,IAAIA,IAAI,EAAEG,WAAW,CAAC,CAAC;IACzB,CAAC,CAAC;IACF,IAAIvB,IAAI,CAACwB,WAAW,EAAE;MACpBL,OAAO,CAACnB,IAAI,CAACwB,WAAW,CAAC;MACzBD,WAAW,CAAC,CAAC;IACf;IACA,OAAO,MAAMA,WAAW,CAAC,CAAC;EAC5B,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAMF,SAAS,GAAG,MAAOD,IAAS,IAAK;IACrC,IAAI,CAACA,IAAI,EAAE;IACX,IAAI;MACF,MAAMK,OAAO,GAAGhC,GAAG,CAACM,EAAE,EAAE,OAAO,EAAEqB,IAAI,CAACM,GAAG,CAAC;MAC1C,MAAMC,QAAQ,GAAG,MAAMjC,MAAM,CAAC+B,OAAO,CAAC;MACtC,IAAI,CAACE,QAAQ,CAACC,MAAM,CAAC,CAAC,EAAE;;MAExB;MACA,IAAIxB,UAAU,CAACyB,MAAM,GAAG,CAAC,EAAE;QACzB,MAAMC,UAAU,GAAGH,QAAQ,CAACI,IAAI,CAAC,CAAC,CAACC,MAAM,IAAI,EAAE;QAC/C,MAAMC,GAAG,GAAG,IAAIC,IAAI,CAAC,CAAC;QACtB,MAAMC,WAAW,GAAG;UAClBC,IAAI,EAAEH,GAAG,CAACI,WAAW,CAAC,CAAC;UACvBC,KAAK,EAAElC,UAAU;UACjBmC,KAAK,EAAEjC,UAAU;UACjBE,QAAQ,EAAEA;QACZ,CAAC;QACD,MAAMb,SAAS,CAAC8B,OAAO,EAAE;UAAEO,MAAM,EAAE,CAAC,GAAGF,UAAU,EAAEK,WAAW;QAAE,CAAC,CAAC;QAClEK,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEN,WAAW,CAAC;MACrC;;MAEA;MACAxB,YAAY,CAAC+B,UAAU,CAAC,wBAAwB,CAAC;MACjD/B,YAAY,CAAC+B,UAAU,CAAC,wBAAwB,CAAC;MACjD/B,YAAY,CAAC+B,UAAU,CAAC,sBAAsB,CAAC;IACjD,CAAC,CAAC,OAAOC,CAAC,EAAE;MACVH,OAAO,CAACI,KAAK,CAAC,YAAY,EAAED,CAAC,CAAC;IAChC;EACF,CAAC;;EAED;EACAxD,SAAS,CAAC,MAAM;IACd;IACAwB,YAAY,CAAC+B,UAAU,CAAC,wBAAwB,CAAC;IACjD,IAAIxB,SAAS,GAAG,KAAK;IACrB,MAAMC,OAAO,GAAIC,IAAS,IAAK;MAC7B,IAAI,CAACF,SAAS,IAAIE,IAAI,EAAE;QACtBC,SAAS,CAACD,IAAI,CAAC;QACfF,SAAS,GAAG,IAAI;MAClB;IACF,CAAC;IACD,MAAMK,WAAW,GAAGhC,kBAAkB,CAACS,IAAI,EAAEoB,IAAI,IAAI;MACnDD,OAAO,CAACC,IAAI,CAAC;MACb,IAAIA,IAAI,EAAEG,WAAW,CAAC,CAAC;IACzB,CAAC,CAAC;IACF;IACA,IAAIvB,IAAI,CAACwB,WAAW,EAAE;MACpBL,OAAO,CAACnB,IAAI,CAACwB,WAAW,CAAC;MACzBD,WAAW,CAAC,CAAC;IACf;IACA;IACA,OAAO,MAAMA,WAAW,CAAC,CAAC;EAC5B,CAAC,EAAE,CAACpB,SAAS,EAAEC,UAAU,EAAEE,UAAU,EAAEE,QAAQ,CAAC,CAAC;;EAEjD;EACA,MAAMqC,QAAQ,GAAGzC,UAAU,CAAC0C,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAK;IAChD,MAAMC,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAACH,IAAI,CAACI,KAAK,CAAC,CAACC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;IAClE,OAAON,GAAG,GAAGE,QAAQ,GAAGD,IAAI,CAACM,QAAQ;EACvC,CAAC,EAAE,CAAC,CAAC;;EAEL;EACA,MAAMC,WAAW,GAAIC,GAAY,IAAK;IACpC,IAAI,CAACA,GAAG,EAAE,OAAO,2BAA2B;IAC5C,IAAIA,GAAG,CAACC,UAAU,CAAC,SAAS,CAAC,IAAID,GAAG,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE,OAAOD,GAAG;IACvE,IAAIA,GAAG,CAACC,UAAU,CAAC,SAAS,CAAC,EAAE,OAAOD,GAAG;IACzC,IAAIA,GAAG,CAACC,UAAU,CAAC,QAAQ,CAAC,EAAE,OAAO,GAAG,GAAGD,GAAG;IAC9C,OAAO,2BAA2B;EACpC,CAAC;EAED,oBACE1D,OAAA;IAAK4D,KAAK,EAAE;MAAEC,QAAQ,EAAE,GAAG;MAAEC,MAAM,EAAE,UAAU;MAAEC,OAAO,EAAE;IAAQ,CAAE;IAAAC,QAAA,eAClEhE,OAAA;MAAK4D,KAAK,EAAE;QAAEK,UAAU,EAAE,MAAM;QAAEC,YAAY,EAAE,EAAE;QAAEH,OAAO,EAAE,MAAM;QAAEI,SAAS,EAAE,mCAAmC;QAAEC,MAAM,EAAE;MAAoB,CAAE;MAAAJ,QAAA,gBACjJhE,OAAA;QAAI4D,KAAK,EAAE;UAAES,KAAK,EAAE,sBAAsB;UAAEC,QAAQ,EAAE,MAAM;UAAEC,YAAY,EAAE,QAAQ;UAAEC,SAAS,EAAE;QAAS,CAAE;QAAAR,QAAA,EAAC;MAAiB;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAEnI5E,OAAA;QAAK4D,KAAK,EAAE;UAAEK,UAAU,EAAE,SAAS;UAAEC,YAAY,EAAE,EAAE;UAAEH,OAAO,EAAE,QAAQ;UAAEQ,YAAY,EAAE;QAAO,CAAE;QAAAP,QAAA,gBAC/FhE,OAAA;UAAI4D,KAAK,EAAE;YAAES,KAAK,EAAE,MAAM;YAAEC,QAAQ,EAAE,QAAQ;YAAEC,YAAY,EAAE;UAAO,CAAE;UAAAP,QAAA,EAAC;QAAI;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,EAEhFtE,UAAU,CAACuE,GAAG,CAAC,CAAC3B,IAAI,EAAE4B,KAAK,kBAC1B9E,OAAA;UAAiB4D,KAAK,EAAE;YAAEmB,OAAO,EAAE,MAAM;YAAEC,UAAU,EAAE,QAAQ;YAAEC,GAAG,EAAE,MAAM;YAAElB,OAAO,EAAE,UAAU;YAAEmB,YAAY,EAAEJ,KAAK,GAAGxE,UAAU,CAACyB,MAAM,GAAG,CAAC,GAAG,mBAAmB,GAAG;UAAO,CAAE;UAAAiC,QAAA,gBAC9KhE,OAAA;YAAKmF,GAAG,EAAE1B,WAAW,CAACP,IAAI,CAACkC,QAAQ,CAAE;YAACC,GAAG,EAAEnC,IAAI,CAACoC,IAAK;YAAC1B,KAAK,EAAE;cAAE2B,KAAK,EAAE,EAAE;cAAEC,MAAM,EAAE,EAAE;cAAEC,SAAS,EAAE,OAAO;cAAEvB,YAAY,EAAE,CAAC;cAAEE,MAAM,EAAE;YAAoB;UAAE;YAAAK,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAC5J5E,OAAA;YAAK4D,KAAK,EAAE;cAAE8B,IAAI,EAAE;YAAE,CAAE;YAAA1B,QAAA,gBACtBhE,OAAA;cAAK4D,KAAK,EAAE;gBAAE+B,UAAU,EAAE,GAAG;gBAAErB,QAAQ,EAAE,OAAO;gBAAEC,YAAY,EAAE;cAAQ,CAAE;cAAAP,QAAA,EAAEd,IAAI,CAACoC;YAAI;cAAAb,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAC5F5E,OAAA;cAAK4D,KAAK,EAAE;gBAAES,KAAK,EAAE,MAAM;gBAAEC,QAAQ,EAAE;cAAS,CAAE;cAAAN,QAAA,GAAC,gBAAI,EAACd,IAAI,CAACM,QAAQ,EAAC,QAAC;YAAA;cAAAiB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC1E,CAAC,eACN5E,OAAA;YAAK4D,KAAK,EAAE;cAAE+B,UAAU,EAAE,GAAG;cAAEtB,KAAK,EAAE,sBAAsB;cAAEC,QAAQ,EAAE;YAAQ,CAAE;YAAAN,QAAA,GAC/E,CAACZ,MAAM,CAACC,MAAM,CAACH,IAAI,CAACI,KAAK,CAAC,CAACC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC,GAAGL,IAAI,CAACM,QAAQ,EAAEoC,cAAc,CAAC,CAAC,EAAC,QACxF;UAAA;YAAAnB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC;QAAA,GAREE,KAAK;UAAAL,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OASV,CACN,CAAC,eAEF5E,OAAA;UAAK4D,KAAK,EAAE;YAAEiC,SAAS,EAAE,QAAQ;YAAEC,UAAU,EAAE,MAAM;YAAEC,SAAS,EAAE;UAAoB,CAAE;UAAA/B,QAAA,gBACtFhE,OAAA;YAAK4D,KAAK,EAAE;cAAEmB,OAAO,EAAE,MAAM;cAAEiB,cAAc,EAAE,eAAe;cAAEzB,YAAY,EAAE;YAAS,CAAE;YAAAP,QAAA,gBACvFhE,OAAA;cAAAgE,QAAA,EAAM;YAAG;cAAAS,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAChB5E,OAAA;cAAAgE,QAAA,GAAOjB,QAAQ,CAAC6C,cAAc,CAAC,CAAC,EAAC,QAAC;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtC,CAAC,eACN5E,OAAA;YAAK4D,KAAK,EAAE;cAAEmB,OAAO,EAAE,MAAM;cAAEiB,cAAc,EAAE,eAAe;cAAEzB,YAAY,EAAE;YAAS,CAAE;YAAAP,QAAA,gBACvFhE,OAAA;cAAAgE,QAAA,EAAM;YAAG;cAAAS,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAChB5E,OAAA;cAAAgE,QAAA,GAAOtD,QAAQ,CAACkF,cAAc,CAAC,CAAC,EAAC,QAAC;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACtC,CAAC,eACN5E,OAAA;YAAK4D,KAAK,EAAE;cAAEmB,OAAO,EAAE,MAAM;cAAEiB,cAAc,EAAE,eAAe;cAAEL,UAAU,EAAE,GAAG;cAAErB,QAAQ,EAAE,OAAO;cAAED,KAAK,EAAE,sBAAsB;cAAE0B,SAAS,EAAE,mBAAmB;cAAED,UAAU,EAAE;YAAS,CAAE;YAAA9B,QAAA,gBACxLhE,OAAA;cAAAgE,QAAA,EAAM;YAAG;cAAAS,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAChB5E,OAAA;cAAAgE,QAAA,GAAOxD,UAAU,CAACoF,cAAc,CAAC,CAAC,EAAC,QAAC;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxC,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC,eAEN5E,OAAA;QAAK4D,KAAK,EAAE;UAAEY,SAAS,EAAE,QAAQ;UAAED,YAAY,EAAE;QAAO,CAAE;QAAAP,QAAA,eACxDhE,OAAA;UAAG4D,KAAK,EAAE;YAAES,KAAK,EAAE,MAAM;YAAE4B,UAAU,EAAE,GAAG;YAAE1B,YAAY,EAAE;UAAO,CAAE;UAAAP,QAAA,GAAC,8GAChD,eAAAhE,OAAA;YAAAyE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,wLAE1B;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAEN5E,OAAA;QAAK4D,KAAK,EAAE;UAAEY,SAAS,EAAE;QAAS,CAAE;QAAAR,QAAA,eAClChE,OAAA,CAACkG,IAAI;UAACC,EAAE,EAAC,eAAe;UAACvC,KAAK,EAAE;YAC9BK,UAAU,EAAE,sBAAsB;YAClCI,KAAK,EAAE,MAAM;YACb+B,cAAc,EAAE,MAAM;YACtBrC,OAAO,EAAE,WAAW;YACpBG,YAAY,EAAE,EAAE;YAChByB,UAAU,EAAE,GAAG;YACfrB,QAAQ,EAAE,OAAO;YACjBS,OAAO,EAAE,cAAc;YACvBZ,SAAS,EAAE;UACb,CAAE;UAAAH,QAAA,EAAC;QAEH;UAAAS,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;EAGR,oBACE5E,OAAA;IAAK4D,KAAK,EAAE;MAAEG,OAAO,EAAE,SAAS;MAAES,SAAS,EAAE;IAAS,CAAE;IAAAR,QAAA,gBACtDhE,OAAA;MAAI4D,KAAK,EAAE;QAAES,KAAK,EAAE,SAAS;QAAEE,YAAY,EAAE;MAAM,CAAE;MAAAP,QAAA,EAAC;IAAe;MAAAS,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAC1E5E,OAAA;MAAAgE,QAAA,GAAG,sFAAc,eAAAhE,OAAA;QAAAyE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,sKAA2B;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,EAGrDtE,UAAU,CAACyB,MAAM,GAAG,CAAC,iBACpB/B,OAAA;MAAK4D,KAAK,EAAE;QAAEE,MAAM,EAAE,UAAU;QAAED,QAAQ,EAAE,GAAG;QAAEI,UAAU,EAAE,MAAM;QAAEC,YAAY,EAAE,EAAE;QAAEC,SAAS,EAAE,mCAAmC;QAAEJ,OAAO,EAAE;MAAM,CAAE;MAAAC,QAAA,gBACtJhE,OAAA;QAAI4D,KAAK,EAAE;UAAES,KAAK,EAAE,SAAS;UAAEE,YAAY,EAAE,EAAE;UAAED,QAAQ,EAAE;QAAS,CAAE;QAAAN,QAAA,EAAC;MAAK;QAAAS,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAGjF5E,OAAA;QAAI4D,KAAK,EAAE;UAAEyC,SAAS,EAAE,MAAM;UAAEtC,OAAO,EAAE,CAAC;UAAED,MAAM,EAAE,CAAC;UAAES,YAAY,EAAE;QAAQ,CAAE;QAAAP,QAAA,EAC5E1D,UAAU,CAACuE,GAAG,CAAC,CAAC3B,IAAI,EAAEoD,GAAG,kBACxBtG,OAAA;UAAc4D,KAAK,EAAE;YAAEmB,OAAO,EAAE,MAAM;YAAEC,UAAU,EAAE,QAAQ;YAAEC,GAAG,EAAE,EAAE;YAAEV,YAAY,EAAE,EAAE;YAAEW,YAAY,EAAE,gBAAgB;YAAEqB,aAAa,EAAE;UAAG,CAAE;UAAAvC,QAAA,gBAC3IhE,OAAA;YAAKmF,GAAG,EAAE1B,WAAW,CAACP,IAAI,CAACkC,QAAQ,CAAE;YAACC,GAAG,EAAEnC,IAAI,CAACoC,IAAK;YAAC1B,KAAK,EAAE;cAAE2B,KAAK,EAAE,EAAE;cAAEC,MAAM,EAAE,EAAE;cAAEC,SAAS,EAAE,OAAO;cAAEvB,YAAY,EAAE,CAAC;cAAEE,MAAM,EAAE,gBAAgB;cAAEH,UAAU,EAAE;YAAU;UAAE;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,eAChL5E,OAAA;YAAK4D,KAAK,EAAE;cAAE8B,IAAI,EAAE,CAAC;cAAElB,SAAS,EAAE;YAAO,CAAE;YAAAR,QAAA,gBACzChE,OAAA;cAAK4D,KAAK,EAAE;gBAAE+B,UAAU,EAAE;cAAI,CAAE;cAAA3B,QAAA,EAAEd,IAAI,CAACoC;YAAI;cAAAb,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAM,CAAC,eAClD5E,OAAA;cAAK4D,KAAK,EAAE;gBAAES,KAAK,EAAE,SAAS;gBAAEC,QAAQ,EAAE;cAAS,CAAE;cAAAN,QAAA,GAAC,gBAAI,EAACd,IAAI,CAACM,QAAQ,EAAC,sBAAK,EAACJ,MAAM,CAACF,IAAI,CAACI,KAAK,CAAC,CAACsC,cAAc,CAAC,CAAC,EAAC,QAAC;YAAA;cAAAnB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAK,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACvH,CAAC;QAAA,GALC0B,GAAG;UAAA7B,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAMR,CACL;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACA,CAAC,eAGL5E,OAAA;QAAK4D,KAAK,EAAE;UAAEmC,SAAS,EAAE,gBAAgB;UAAED,UAAU,EAAE;QAAM,CAAE;QAAA9B,QAAA,gBAC7DhE,OAAA;UAAK4D,KAAK,EAAE;YAAEmB,OAAO,EAAE,MAAM;YAAEiB,cAAc,EAAE,eAAe;YAAEzB,YAAY,EAAE,OAAO;YAAED,QAAQ,EAAE;UAAM,CAAE;UAAAN,QAAA,gBACvGhE,OAAA;YAAAgE,QAAA,EAAM;UAAG;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAChB5E,OAAA;YAAAgE,QAAA,GAAOjB,QAAQ,CAAC6C,cAAc,CAAC,CAAC,EAAC,QAAC;UAAA;YAAAnB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtC,CAAC,eACN5E,OAAA;UAAK4D,KAAK,EAAE;YAAEmB,OAAO,EAAE,MAAM;YAAEiB,cAAc,EAAE,eAAe;YAAEzB,YAAY,EAAE,OAAO;YAAED,QAAQ,EAAE;UAAM,CAAE;UAAAN,QAAA,gBACvGhE,OAAA;YAAAgE,QAAA,EAAM;UAAG;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eAChB5E,OAAA;YAAAgE,QAAA,EAAOtD,QAAQ,KAAK,CAAC,GAAG,IAAI,GAAGA,QAAQ,CAACkF,cAAc,CAAC,CAAC,GAAG;UAAG;YAAAnB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAO,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACnE,CAAC,eACN5E,OAAA;UAAK4D,KAAK,EAAE;YAAEmB,OAAO,EAAE,MAAM;YAAEiB,cAAc,EAAE,eAAe;YAAEH,SAAS,EAAE,KAAK;YAAEF,UAAU,EAAE,GAAG;YAAErB,QAAQ,EAAE,QAAQ;YAAED,KAAK,EAAE,SAAS;YAAE0B,SAAS,EAAE,gBAAgB;YAAED,UAAU,EAAE;UAAQ,CAAE;UAAA9B,QAAA,gBAC1LhE,OAAA;YAAAgE,QAAA,EAAM;UAAO;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC,eACpB5E,OAAA;YAAAgE,QAAA,GAAOxD,UAAU,CAACoF,cAAc,CAAC,CAAC,EAAC,QAAC;UAAA;YAAAnB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACxC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CACN,eAED5E,OAAA;MAAGwG,IAAI,EAAC,eAAe;MAAC5C,KAAK,EAAE;QAAEmB,OAAO,EAAE,cAAc;QAAEc,SAAS,EAAE,KAAK;QAAExB,KAAK,EAAE,MAAM;QAAEJ,UAAU,EAAE,SAAS;QAAEF,OAAO,EAAE,WAAW;QAAEG,YAAY,EAAE,CAAC;QAAEkC,cAAc,EAAE,MAAM;QAAET,UAAU,EAAE;MAAI,CAAE;MAAA3B,QAAA,EAAC;IAAO;MAAAS,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAC5M,CAAC;AAEV,CAAC;AAACxE,EAAA,CAzNID,OAAiB;EAAA,QACCZ,OAAO;AAAA;AAAAkH,EAAA,GADzBtG,OAAiB;AA2NvB,eAAeA,OAAO;AAAC,IAAAsG,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}